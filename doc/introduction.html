<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<!-- <style type="text/css"> &ndash;>

<!-- .main-container { -->

<!--   max-width: 2800px;!important -->

<!--   margin-left: auto; -->

<!--   margin-right: auto; -->

<!-- } -->

<!-- </style> &ndash;>

<p><img src="data:image/png;base64,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" height="139px" width="120px" /></p>

<h1>Introduction</h1>

<p>ttBulk is a collection of wrapper functions for bulk tanscriptomic analyses that follows the &ldquo;tidy&rdquo; paradigm. The data structure is a tibble with columns for </p>

<ul>
<li>sample identifier column</li>
<li>transcript identifier column</li>
<li>count column</li>
<li>annotation (and other info) columns</li>
</ul>

<pre><code class="r">counts = ttBulk::counts_mini
counts 
</code></pre>

<pre><code>## # A tibble: 2,635 x 6
##    sample     transcript `Cell type` count time  condition
##    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;lgl&gt;    
##  1 SRR1740034 TNFRSF4    b_cell          6 0 d   TRUE     
##  2 SRR1740034 PLCH2      b_cell        926 0 d   TRUE     
##  3 SRR1740034 PADI4      b_cell         21 0 d   TRUE     
##  4 SRR1740034 PAX7       b_cell          0 0 d   TRUE     
##  5 SRR1740034 CDA        b_cell          1 0 d   TRUE     
##  6 SRR1740034 RCAN3      b_cell        905 0 d   TRUE     
##  7 SRR1740034 SMPDL3B    b_cell          3 0 d   TRUE     
##  8 SRR1740034 EPB41      b_cell       4667 0 d   TRUE     
##  9 SRR1740034 LCK        b_cell        436 0 d   TRUE     
## 10 SRR1740034 COL8A2     b_cell          1 0 d   TRUE     
## # ... with 2,625 more rows
</code></pre>

<p>In brief you can:</p>

<ul>
<li>Going from BAM/SAM to a tidy data frame of counts (FeatureCounts)</li>
<li>Adding gene symbols from ensembl IDs</li>
<li>Aggregating duplicated gene symbols</li>
<li>Adding normalised counts</li>
<li>Adding principal components</li>
<li>Adding MDS components</li>
<li>Rotating principal component or MDS dimensions</li>
<li>Running differential transcript abunance analyses (edgeR)</li>
<li>Adding batch adjusted counts (Combat) </li>
<li>Eliminating redunant samples and/or genes</li>
<li>Clustering samples and/or genes with kmeans</li>
<li>Adding tissue composition (Cibersort)</li>
</ul>

<h1>Aggregate <code>transcripts</code></h1>

<p>ttBulk provide the <code>aggregate_duplicates</code> function to aggregate duplicated transcripts (e.g., isoforms, ensembl). For example, we often have to convert ensembl symbols to gene/transcript symbol, but in doing so we have to deal with duplicates. <code>aggregate_duplicates</code> takes a tibble and column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) as arguments and returns a tibble with aggregate transcript with the same name. All the rest of the column are appended, and factors and boolean are appended as characters.</p>

<pre><code class="r">counts.aggr = 
  counts %&gt;%
  aggregate_duplicates(
    sample, 
    transcript, 
    `count`,  
    aggregation_function = sum
  )
</code></pre>

<pre><code>## Converted to characters
## condition 
## &quot;logical&quot;
</code></pre>

<pre><code class="r">counts.aggr 
</code></pre>

<pre><code>## # A tibble: 2,635 x 7
##    sample transcript `Cell type` count time  condition `merged transcripts`
##    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
##  1 SRR17~ TNFRSF4    b_cell          6 0 d   TRUE                         1
##  2 SRR17~ PLCH2      b_cell        926 0 d   TRUE                         1
##  3 SRR17~ PADI4      b_cell         21 0 d   TRUE                         1
##  4 SRR17~ PAX7       b_cell          0 0 d   TRUE                         1
##  5 SRR17~ CDA        b_cell          1 0 d   TRUE                         1
##  6 SRR17~ RCAN3      b_cell        905 0 d   TRUE                         1
##  7 SRR17~ SMPDL3B    b_cell          3 0 d   TRUE                         1
##  8 SRR17~ EPB41      b_cell       4667 0 d   TRUE                         1
##  9 SRR17~ LCK        b_cell        436 0 d   TRUE                         1
## 10 SRR17~ COL8A2     b_cell          1 0 d   TRUE                         1
## # ... with 2,625 more rows
</code></pre>

<h1>Normalise <code>counts</code></h1>

<p>We may want to calculate the normalised counts for library size (e.g., with TMM algorithm, Robinson and Oshlack doi.org/10.1186/gb-2010-11-3-r25). <code>normalise_counts</code> takes a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and a method as arguments and returns a tibble with additional columns with normalised data as <code>&lt;NAME OF COUNT COLUMN&gt; normalised</code>.</p>

<pre><code class="r">counts.norm =  counts.aggr %&gt;% 
    normalise_counts(sample, transcript, `count`)

counts.norm %&gt;% select(`count`, `count normalised`, `filter out low counts`, everything())
</code></pre>

<pre><code>## # A tibble: 2,635 x 11
##    count `count normalised` `filter out low counts` sample transcript
##    &lt;dbl&gt;              &lt;dbl&gt; &lt;lgl&gt;                   &lt;chr&gt;  &lt;chr&gt;     
##  1  1035            1164.   FALSE                   SRR17~ ABCB4     
##  2    45              50.6  FALSE                   SRR17~ ABCB9     
##  3  7151            8043.   FALSE                   SRR17~ ACAP1     
##  4     2               2.25 TRUE                    SRR17~ ACHE      
##  5  2278            2562.   FALSE                   SRR17~ ACP5      
##  6 11156           12547.   FALSE                   SRR17~ ADAM28    
##  7    72              81.0  FALSE                   SRR17~ ADAMDEC1  
##  8     0               0    TRUE                    SRR17~ ADAMTS3   
##  9   298             335.   FALSE                   SRR17~ ADRB2     
## 10     8               9.00 FALSE                   SRR17~ AIF1      
## # ... with 2,625 more rows, and 6 more variables: `Cell type` &lt;chr&gt;,
## #   time &lt;chr&gt;, condition &lt;chr&gt;, `merged transcripts` &lt;dbl&gt;, TMM &lt;dbl&gt;,
## #   multiplier &lt;dbl&gt;
</code></pre>

<p>We can easily plot the normalised density to check the normalisation outcome. On the x axis we have the log scaled counts, on the y axes we have the density, data is grouped by sample and coloured by cell type. </p>

<pre><code class="r">counts.norm %&gt;% 
    ggplot(aes(`count normalised` + 1, group=sample, color=`Cell type`)) +
    geom_density() + 
    scale_x_log10() +
    my_theme
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_normalise"/></p>

<h1>Reduce <code>dimensions</code></h1>

<p>We may want to reduce the dimensions of our data, for example using PCA or MDS algorithms. <code>reduce_dimensions</code> takes a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and a method (e.g., MDS or PCA) as arguments and returns a tibble with additional columns for the reduced dimensions.</p>

<p><strong>MDS</strong> (Robinson et al., 10.1093/bioinformatics/btp616)</p>

<pre><code class="r">counts.norm.MDS =
  counts.norm %&gt;%
  reduce_dimensions(.value = `count normalised`, method=&quot;MDS&quot; , .element = sample, .feature = transcript, components = 1:3)

counts.norm.MDS %&gt;% select(sample, contains(&quot;Dim&quot;), `Cell type`, time ) %&gt;% distinct()
</code></pre>

<pre><code>## # A tibble: 5 x 6
##   sample     `Dim 1` `Dim 2`  `Dim 3` `Cell type`       time 
##   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;
## 1 SRR1740034   1.44   -0.906  0.0270  b_cell            0 d  
## 2 SRR1740035   1.42   -0.898  0.0549  b_cell            1 d  
## 3 SRR1740043  -2.05   -0.148  0.652   monocyte          1 d  
## 4 SRR1740058   0.859   2.19  -0.00119 t_cell            0 d  
## 5 SRR1740067  -1.67   -0.236 -0.732   dendritic_myeloid 1 d
</code></pre>

<p>On the x and y axes axis we have the reduced dimensions 1 to 3, data is coloured by cell type. </p>

<pre><code class="r">counts.norm.MDS %&gt;%
    select(contains(&quot;Dim&quot;), sample, `Cell type`) %&gt;%
  distinct() %&gt;%
  GGally::ggpairs(columns = 1:3, ggplot2::aes(colour=`Cell type`))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_mds"/></p>

<p><strong>PCA</strong></p>

<pre><code class="r">counts.norm.PCA =
  counts.norm %&gt;%
  reduce_dimensions(.value = `count normalised`, method=&quot;PCA&quot; , .element = sample, .feature = transcript, components = 1:3)
</code></pre>

<pre><code>## Fraction of variance explained by the selected principal components
## # A tibble: 3 x 2
##   `Fraction of variance`    PC
##                    &lt;dbl&gt; &lt;int&gt;
## 1                  0.617     1
## 2                  0.233     2
## 3                  0.128     3
</code></pre>

<pre><code class="r">counts.norm.PCA %&gt;% select(sample, contains(&quot;PC&quot;), `Cell type`, time ) %&gt;% distinct()
</code></pre>

<pre><code>## # A tibble: 5 x 6
##   sample        PC1    PC2      PC3 `Cell type`       time 
##   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;
## 1 SRR1740034 -0.496 -0.379  0.332   b_cell            0 d  
## 2 SRR1740035 -0.497 -0.375  0.330   b_cell            1 d  
## 3 SRR1740043 -0.417  0.597 -0.0370  monocyte          1 d  
## 4 SRR1740058 -0.358 -0.304 -0.883   t_cell            0 d  
## 5 SRR1740067 -0.453  0.517  0.00635 dendritic_myeloid 1 d
</code></pre>

<p>On the x and y axes axis we have the reduced dimensions 1 to 3, data is coloured by cell type. </p>

<pre><code class="r">counts.norm.PCA %&gt;%
    select(contains(&quot;PC&quot;), sample, `Cell type`) %&gt;%
  distinct() %&gt;%
  GGally::ggpairs(columns = 1:3, ggplot2::aes(colour=`Cell type`))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_pca"/></p>

<h1>Rotate <code>dimensions</code></h1>

<p>We may want to rotate the reduced dimensions (or any two numeric columns really) of our data, of a set angle. <code>rotate_dimensions</code> takes a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and an angle as arguments and returns a tibble with additional columns for the rotated dimensions. The rotated dimensions will be added to the original data set as <code>&lt;NAME OF DIMENSION&gt; rotated &lt;ANGLE&gt;</code> by default, or as specified in the input arguments.</p>

<pre><code class="r">counts.norm.MDS.rotated =
  counts.norm.MDS %&gt;%
    rotate_dimensions(`Dim 1`, `Dim 2`, rotation_degrees = 45, .element = sample)
</code></pre>

<p><strong>Original</strong>
On the x and y axes axis we have the first two reduced dimensions, data is coloured by cell type. </p>

<pre><code class="r">counts.norm.MDS.rotated %&gt;%
    distinct(sample, `Dim 1`,`Dim 2`, `Cell type`) %&gt;%
    ggplot(aes(x=`Dim 1`, y=`Dim 2`, color=`Cell type` )) +
  geom_point() +
  my_theme
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_rotate_1"/></p>

<p><strong>Rotated</strong>
On the x and y axes axis we have the first two reduced dimensions rotated of 45 degrees, data is coloured by cell type. </p>

<pre><code class="r">counts.norm.MDS.rotated %&gt;%
    distinct(sample, `Dim 1 rotated 45`,`Dim 2 rotated 45`, `Cell type`) %&gt;%
    ggplot(aes(x=`Dim 1 rotated 45`, y=`Dim 2 rotated 45`, color=`Cell type` )) +
  geom_point() +
  my_theme
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_rotate_2"/></p>

<h1>Annotate <code>differential transcirption</code></h1>

<p>We may want to test for differential transcription between sample-wise factors of interest (e.g., with edgeR). <code>test_differential_transcription</code> takes a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and a formula representing the desired linear model as arguments and returns a tibble with additional columns for the statistics from the hypothesis test (e.g.,  log fold change, p-value and false discovery rate). </p>

<pre><code class="r">counts %&gt;%
    test_differential_transcription(
      ~ condition,
      .sample = sample,
      .transcript = transcript,
      .abundance = `count`,
      action=&quot;get&quot;)
</code></pre>

<pre><code>## # A tibble: 527 x 8
##    transcript logFC logCPM    LR  PValue     FDR is_de
##    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;lgl&gt;
##  1 FCN1       -12.5  15.3   35.0 3.37e-9 9.05e-7 TRUE 
##  2 HK3        -12.1  13.4   34.6 4.08e-9 9.05e-7 TRUE 
##  3 CLEC7A     -11.5  12.7   32.9 9.68e-9 1.43e-6 TRUE 
##  4 FAM198B    -13.4  11.4   31.6 1.90e-8 2.11e-6 TRUE 
##  5 CD33       -11.8  11.4   30.5 3.42e-8 3.04e-6 TRUE 
##  6 CSF3R      -11.1  13.4   28.5 9.46e-8 7.00e-6 TRUE 
##  7 FPR1       -11.2  11.5   27.3 1.78e-7 9.12e-6 TRUE 
##  8 CDA        -11.3   9.36  27.2 1.82e-7 9.12e-6 TRUE 
##  9 AQP9       -11.0  10.2   26.9 2.09e-7 9.12e-6 TRUE 
## 10 HNMT       -11.4   9.35  26.9 2.09e-7 9.12e-6 TRUE 
## # ... with 517 more rows, and 1 more variable: `filter out low
## #   counts` &lt;lgl&gt;
</code></pre>

<h1>Adjust <code>counts</code></h1>

<p>We may want to adjust <code>counts</code> for (known) unwanted variation. <code>adjust_abundance</code> takes as arguments a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and a formula representing the desired linear model where the first covariate is the factor of interest and the second covariate is the unwanted variation, and returns a tibble with additional columns for the adjusted counts as <code>&lt;COUNT COLUMN&gt; adjusted</code>. At the moment just an unwanted covariated is allowed at a time.</p>

<p><strong>&ldquo;## Standardizing Data across genes&rdquo; is still in the cache?</strong></p>

<pre><code class="r">counts.norm.adj =
    counts.norm %&gt;%

      # Add fake batch and factor of interest
      left_join(
        (.) %&gt;%
            distinct(sample) %&gt;%
            mutate(batch = c(0,1,0,1,1))
      ) %&gt;%
        mutate(factor_of_interest = `Cell type` == &quot;b_cell&quot;) %&gt;%

      # Add covariate
      adjust_abundance(
        ~ factor_of_interest + batch,
        sample,
        transcript,
        `count normalised`,
        action = &quot;get&quot;
      )
</code></pre>

<pre><code>## Standardizing Data across genes
</code></pre>

<pre><code class="r">counts.norm.adj
</code></pre>

<pre><code>## # A tibble: 2,635 x 4
##    transcript sample    `count normalised adjusted` `filter out low counts`
##    &lt;chr&gt;      &lt;chr&gt;                           &lt;int&gt; &lt;lgl&gt;                  
##  1 ABCB4      SRR17400~                        1759 FALSE                  
##  2 ABCB9      SRR17400~                          72 FALSE                  
##  3 ACAP1      SRR17400~                        8613 FALSE                  
##  4 ACHE       SRR17400~                          NA TRUE                   
##  5 ACP5       SRR17400~                        2341 FALSE                  
##  6 ADAM28     SRR17400~                        7344 FALSE                  
##  7 ADAMDEC1   SRR17400~                          38 FALSE                  
##  8 ADAMTS3    SRR17400~                          NA TRUE                   
##  9 ADRB2      SRR17400~                         416 FALSE                  
## 10 AIF1       SRR17400~                           4 FALSE                  
## # ... with 2,625 more rows
</code></pre>

<h1>Annotate <code>Cell type composition</code></h1>

<p>We may want to infer the cell type composition of our samples (with the algorithm Cibersort; Newman et al., 10.1038/nmeth.3337). <code>annotate_cell_type</code> takes as arguments a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and returns a tibble with additional columns for the adjusted  cell type proportions.</p>

<p><strong>columns truncated</strong></p>

<pre><code class="r">counts.cibersort =
    counts %&gt;%
    annotate_cell_type(sample, transcript, `count`, action=&quot;add&quot;, cores=2)

counts.cibersort %&gt;% select(sample, contains(&quot;type:&quot;)) %&gt;% distinct()
</code></pre>

<pre><code>## # A tibble: 5 x 23
##   sample `type: B cells naive` `type: B cells memory` `type: Plasma cells`
##   &lt;chr&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;                &lt;dbl&gt;
## 1 SRR17~               0.622                    0.238            0        
## 2 SRR17~               0.611                    0.257            0        
## 3 SRR17~               0                        0                0.0000452
## 4 SRR17~               0.00232                  0                0.000493 
## 5 SRR17~               0                        0                0        
## # ... with 19 more variables: `type: T cells CD8` &lt;dbl&gt;, `type: T cells
## #   CD4 naive` &lt;dbl&gt;, `type: T cells CD4 memory resting` &lt;dbl&gt;, `type: T
## #   cells CD4 memory activated` &lt;dbl&gt;, `type: T cells follicular
## #   helper` &lt;dbl&gt;, `type: T cells regulatory (Tregs)` &lt;dbl&gt;, `type: T
## #   cells gamma delta` &lt;dbl&gt;, `type: NK cells resting` &lt;dbl&gt;, `type: NK
## #   cells activated` &lt;dbl&gt;, `type: Monocytes` &lt;dbl&gt;, `type: Macrophages
## #   M0` &lt;dbl&gt;, `type: Macrophages M1` &lt;dbl&gt;, `type: Macrophages M2` &lt;dbl&gt;,
## #   `type: Dendritic cells resting` &lt;dbl&gt;, `type: Dendritic cells
## #   activated` &lt;dbl&gt;, `type: Mast cells resting` &lt;dbl&gt;, `type: Mast cells
## #   activated` &lt;dbl&gt;, `type: Eosinophils` &lt;dbl&gt;, `type: Neutrophils` &lt;dbl&gt;
</code></pre>

<p>With the new annotated data frame, we can plot the distributions of cell types across samples, and compare them with the nominal cell type labels to check for the purity of isolation. On the x axis we have the cell types inferred by Cibersort, on the y axis we have the inferred proportions. The data is facetted and coloured by nominal cell types (annotation given by the researcher after FACS sorting).</p>

<pre><code class="r">counts.cibersort %&gt;%
    select(contains(&quot;type:&quot;), everything()) %&gt;%
    gather(`Cell type inferred`, `proportion`, 1:22) %&gt;%
  distinct(sample, `Cell type`, `Cell type inferred`, proportion) %&gt;%
  ggplot(aes(x=`Cell type inferred`, y=proportion, fill=`Cell type`)) +
  geom_boxplot() +
  facet_wrap(~`Cell type`) +
  my_theme +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5), aspect.ratio=1/5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_cibersort"/></p>

<h1>Annotate <code>clusters</code></h1>

<p>We may want to cluster our data (e.g., using k-means sample-wise). <code>annotate_clusters</code> takes as arguments a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and returns a tibble with additional columns for the cluster annotation. At the moment only k-means clustering is supported, the plan is to introduce more clustering methods.</p>

<p><strong>k-means</strong></p>

<pre><code class="r">counts.norm.cluster = counts.norm %&gt;%
  annotate_clusters(.value = `count normalised`, .element = sample, .feature = transcript,  number_of_clusters = 2 )

counts.norm.cluster
</code></pre>

<pre><code>## # A tibble: 2,635 x 12
##    sample transcript `Cell type` count time  condition `merged transcripts`
##    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
##  1 SRR17~ ABCB4      b_cell       1035 0 d   TRUE                         1
##  2 SRR17~ ABCB9      b_cell         45 0 d   TRUE                         1
##  3 SRR17~ ACAP1      b_cell       7151 0 d   TRUE                         1
##  4 SRR17~ ACHE       b_cell          2 0 d   TRUE                         1
##  5 SRR17~ ACP5       b_cell       2278 0 d   TRUE                         1
##  6 SRR17~ ADAM28     b_cell      11156 0 d   TRUE                         1
##  7 SRR17~ ADAMDEC1   b_cell         72 0 d   TRUE                         1
##  8 SRR17~ ADAMTS3    b_cell          0 0 d   TRUE                         1
##  9 SRR17~ ADRB2      b_cell        298 0 d   TRUE                         1
## 10 SRR17~ AIF1       b_cell          8 0 d   TRUE                         1
## # ... with 2,625 more rows, and 5 more variables: `count
## #   normalised` &lt;dbl&gt;, TMM &lt;dbl&gt;, multiplier &lt;dbl&gt;, `filter out low
## #   counts` &lt;lgl&gt;, cluster &lt;fct&gt;
</code></pre>

<p>We can add cluster annotation to the MDS dimesion reduced data set and plot.</p>

<pre><code class="r"> counts.norm.MDS %&gt;%
  annotate_clusters(
    .value = `count normalised`,
    .element = sample,
    .feature = transcript,
    number_of_clusters = 2
  ) %&gt;%
    distinct(sample, `Dim 1`, `Dim 2`, cluster) %&gt;%
    ggplot(aes(x=`Dim 1`, y=`Dim 2`, color=cluster)) +
  geom_point() +
  my_theme
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_cluster"/></p>

<h1>Drop <code>redundant</code></h1>

<p>We may want to remove redundant elements from the original data set (e.g., samples or transcripts), for example if we want to define cell-type specific signatures with low sample redundancy. <code>drop_redundant</code> takes as arguments a tibble, column names (as symbols; for <code>sample</code>, <code>transcript</code> and <code>count</code>) and returns a tibble dropped recundant elements (e.g., samples). Two redundancy estimation approaches are supported: </p>

<ul>
<li>removal of highly correlated clusters of elements (keeping a representative) with method=&ldquo;correlation&rdquo;</li>
<li>removal of most proximal element pairs in a reduced dimensional space.</li>
</ul>

<p><strong>Approach 1</strong></p>

<pre><code class="r">counts.norm.non_redundant =
    counts.norm.MDS %&gt;%
  drop_redundant(
    method = &quot;correlation&quot;,
    .element = sample,
    .feature = transcript,
    .value = `count normalised`
  )
</code></pre>

<p>We can visualise how the reduced redundancy with the reduced dimentions look like</p>

<pre><code class="r">counts.norm.non_redundant %&gt;%
    distinct(sample, `Dim 1`, `Dim 2`, `Cell type`) %&gt;%
    ggplot(aes(x=`Dim 1`, y=`Dim 2`, color=`Cell type`)) +
  geom_point() +
  my_theme
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot_drop"/></p>

<p><strong>Approach 2</strong></p>

<pre><code class="r">counts.norm.non_redundant =
    counts.norm.MDS %&gt;%
  drop_redundant(
    method = &quot;reduced_dimensions&quot;,
    .element = sample,
    .feature = transcript,
    Dim_a_column = `Dim 1`,
    Dim_b_column = `Dim 2`
  )
</code></pre>

<p>We can visualise MDS reduced dimensions of the samples with the closest pair removed.</p>

<pre><code class="r">counts.norm.non_redundant %&gt;%
    distinct(sample, `Dim 1`, `Dim 2`, `Cell type`) %&gt;%
    ggplot(aes(x=`Dim 1`, y=`Dim 2`, color=`Cell type`)) +
  geom_point() +
  my_theme
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAzFBMVEUAAAAAADoAAGYAOjoAOpAAZrYAujgzMzM6AAA6ADo6AGY6Ojo6OpA6ZmY6ZrY6kNtNTU1NTW5NTY5NbqtNjshhnP9mAABmADpmAGZmOpBmZgBmZjpmZmZmkNtmtv9uq+SOTY6OyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+rbk2rbo6rq8ir5P+2ZgC2Zjq2kJC2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+v4dm3/tmb/yI7/25D//7b//8j//9v//+T///87JI/vAAAACXBIWXMAAAsSAAALEgHS3X78AAAOBElEQVR4nO2dDVsaZxpGiRslm2QX20ST3e6SD7sfNi1tNdSkEgzy//9T52UAQYkZejPMc/Oe50quEOHMe5zjzKAm2BozWU6raQGmmSF8pkP4TIfwmc6mwlfbzu/CCk2xltJfZwkfdmHCN8taShNeZy2lCa+zltKE11lLacLrrKU04XXWUprwOmspTXidtZQmvM5aShNeZy2lCa+zltKE11lLacLrrKU04XXWUprwOrulhY+Otrsu4WMsfHR0pzzhm2UJv4HtEP6Lw6k+GmspTXidtZQmvM5aShNeZy2lCa+zltKE11lLacLrrKU04XXWUprwOmspTXidtZQmvM5aShNeZy2lCa+zltKE11lLacLrrKU04XXWUprwOmspTXidtZQmvM5aStcc/vqHw8NnH9fYTtz9EHDhwOE/PR+Pz9+ssZ24+yHgwoHDp/lQhG+3263fmYBTX/h00FffTtwDIODCoY/48+drbSfufgi4cODw1z+8WW87cfdDwIUDhz8/LObVGtuJux8CLhw4/NrbibsfAi5M+GZZS2nC66ylNOF11lKa8DprKU14nbWUJrzOWkoTXmctpQmvs5bShNdZS2nC66ylNOF11lKa8DprKU14nbWUJrzOWkoTXmctpQmvs5bShNdZS2nC66ylNOF11lKa8DprKU14nbWUJrzOWkoTXmctpQmvs5bShNdZS2nC66ylNOF11lKa8DprKU14nbWUJrzOWkoTXmctpQmvs5bShNdZS2nC66ylNOF11lKa8DprKU14nbWUJrzOWkoTXmctpQmvs5bShNdZS2nC66ylNOF11lKa8DprKU14nbWUJrzO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" alt="plot of chunk plot_drop2"/></p>

<h1>Other useful wrappers</h1>

<p>The above wrapper streamline the most common processing of bulk RNA sequencing data. Other useful wrappers are listed above.</p>

<h2>From BAM/SAM to tibble of gene counts</h2>

<p>We can calculate gene counts (using FeatureCounts; Liao Y et al., 10.1093/nar/gkz114) from a list of BAM/SAM files and format them into a tidy structure (similar to counts).</p>

<pre><code class="r">counts = bam_sam_to_featureCounts_tibble(
    file_names, 
    genome = &quot;hg38&quot;,
    isPairedEnd = T,
    requireBothEndsMapped = T,
    checkFragLength = F,
    useMetaFeatures = T
)
</code></pre>

<h2>From ensembl IDs to gene symbol IDs</h2>

<p>We can add gene symbols from ensembl identifiers. This is useful since different resources use ensembl IDs while others use gene symbol IDs.</p>

<pre><code class="r">counts_ensembl %&gt;% annotate_symbol(ens)
</code></pre>

<pre><code>## # A tibble: 119 x 8
##    ens   iso   `read count` sample cases_0_project_disease_type
##    &lt;chr&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;                       
##  1 ENSG~ 13             144 TARGE~ Acute Myeloid Leukemia      
##  2 ENSG~ 13              72 TARGE~ Acute Myeloid Leukemia      
##  3 ENSG~ 13               0 TARGE~ Acute Myeloid Leukemia      
##  4 ENSG~ 13            1099 TARGE~ Acute Myeloid Leukemia      
##  5 ENSG~ 13              11 TARGE~ Acute Myeloid Leukemia      
##  6 ENSG~ 13               2 TARGE~ Acute Myeloid Leukemia      
##  7 ENSG~ 13               3 TARGE~ Acute Myeloid Leukemia      
##  8 ENSG~ 13            2678 TARGE~ Acute Myeloid Leukemia      
##  9 ENSG~ 13             751 TARGE~ Acute Myeloid Leukemia      
## 10 ENSG~ 13               1 TARGE~ Acute Myeloid Leukemia      
## # ... with 109 more rows, and 3 more variables:
## #   cases_0_samples_0_sample_type &lt;chr&gt;, hgnc_symbol &lt;chr&gt;, hg &lt;chr&gt;
</code></pre>

<h1>ADD versus GET modes</h1>

<p>Every function takes this structure as input, and outputs either (i) the new information joint to the original input data frame (default), or (ii) just the new information, setting action=&ldquo;add&rdquo; or action=&ldquo;get&rdquo; respectively. For example, from this data set</p>

<pre><code class="r">  counts.norm 
</code></pre>

<pre><code>## # A tibble: 2,635 x 11
##    sample transcript `Cell type` count time  condition `merged transcripts`
##    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
##  1 SRR17~ ABCB4      b_cell       1035 0 d   TRUE                         1
##  2 SRR17~ ABCB9      b_cell         45 0 d   TRUE                         1
##  3 SRR17~ ACAP1      b_cell       7151 0 d   TRUE                         1
##  4 SRR17~ ACHE       b_cell          2 0 d   TRUE                         1
##  5 SRR17~ ACP5       b_cell       2278 0 d   TRUE                         1
##  6 SRR17~ ADAM28     b_cell      11156 0 d   TRUE                         1
##  7 SRR17~ ADAMDEC1   b_cell         72 0 d   TRUE                         1
##  8 SRR17~ ADAMTS3    b_cell          0 0 d   TRUE                         1
##  9 SRR17~ ADRB2      b_cell        298 0 d   TRUE                         1
## 10 SRR17~ AIF1       b_cell          8 0 d   TRUE                         1
## # ... with 2,625 more rows, and 4 more variables: `count
## #   normalised` &lt;dbl&gt;, TMM &lt;dbl&gt;, multiplier &lt;dbl&gt;, `filter out low
## #   counts` &lt;lgl&gt;
</code></pre>

<p><strong>action=&ldquo;add&rdquo;</strong> (Default)
We can add the MDS dimensions to the original data set</p>

<pre><code class="r">  counts.norm %&gt;%
    reduce_dimensions(
        .value = `count normalised`, 
        method=&quot;MDS&quot; , 
        .element = sample, 
        .feature = transcript, 
        components = 1:3, 
        action=&quot;add&quot;
    )
</code></pre>

<pre><code>## # A tibble: 2,635 x 14
##    sample transcript `Cell type` count time  condition `merged transcripts`
##    &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;                    &lt;dbl&gt;
##  1 SRR17~ ABCB4      b_cell       1035 0 d   TRUE                         1
##  2 SRR17~ ABCB9      b_cell         45 0 d   TRUE                         1
##  3 SRR17~ ACAP1      b_cell       7151 0 d   TRUE                         1
##  4 SRR17~ ACHE       b_cell          2 0 d   TRUE                         1
##  5 SRR17~ ACP5       b_cell       2278 0 d   TRUE                         1
##  6 SRR17~ ADAM28     b_cell      11156 0 d   TRUE                         1
##  7 SRR17~ ADAMDEC1   b_cell         72 0 d   TRUE                         1
##  8 SRR17~ ADAMTS3    b_cell          0 0 d   TRUE                         1
##  9 SRR17~ ADRB2      b_cell        298 0 d   TRUE                         1
## 10 SRR17~ AIF1       b_cell          8 0 d   TRUE                         1
## # ... with 2,625 more rows, and 7 more variables: `count
## #   normalised` &lt;dbl&gt;, TMM &lt;dbl&gt;, multiplier &lt;dbl&gt;, `filter out low
## #   counts` &lt;lgl&gt;, `Dim 1` &lt;dbl&gt;, `Dim 2` &lt;dbl&gt;, `Dim 3` &lt;dbl&gt;
</code></pre>

<p><strong>action=&ldquo;get&rdquo;</strong>
We can get just the MDS dimensions relative to each sample</p>

<pre><code class="r">  counts.norm %&gt;%
    reduce_dimensions(
        .value = `count normalised`, 
        method=&quot;MDS&quot; , 
        .element = sample, 
        .feature = transcript, 
        components = 1:3, 
        action=&quot;get&quot;
    )
</code></pre>

<pre><code>## # A tibble: 5 x 4
##   sample     `Dim 1` `Dim 2`  `Dim 3`
##   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1 SRR1740034   1.44   -0.906  0.0270 
## 2 SRR1740035   1.42   -0.898  0.0549 
## 3 SRR1740043  -2.05   -0.148  0.652  
## 4 SRR1740058   0.859   2.19  -0.00119
## 5 SRR1740067  -1.67   -0.236 -0.732
</code></pre>

<h1>Appendix</h1>

<pre><code class="r">sessionInfo()
</code></pre>

<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17763)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   
## [3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      
## [5] LC_TIME=English_Australia.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ttBulk_0.1.0  purrr_0.3.2   rlang_0.4.0   foreach_1.4.7 widyr_0.1.1  
##  [6] readr_1.3.1   ggplot2_3.2.0 tidyr_0.8.3   magrittr_1.5  dplyr_0.8.3  
## [11] tibble_2.1.3  knitr_1.23   
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-139          matrixStats_0.54.0    bitops_1.0-6         
##  [4] fs_1.3.1              usethis_1.5.1         devtools_2.1.0       
##  [7] bit64_0.9-7           RColorBrewer_1.1-2    rprojroot_1.3-2      
## [10] SnowballC_0.6.0       tools_3.6.0           backports_1.1.4      
## [13] utf8_1.1.4            R6_2.4.0              mgcv_1.8-28          
## [16] DBI_1.0.0             lazyeval_0.2.2        BiocGenerics_0.30.0  
## [19] colorspace_1.4-1      withr_2.1.2           tidyselect_0.2.5     
## [22] prettyunits_1.0.2     GGally_1.4.0          processx_3.4.1       
## [25] bit_1.1-14            compiler_3.6.0        preprocessCore_1.46.0
## [28] cli_1.1.0             Biobase_2.44.0        desc_1.2.0           
## [31] labeling_0.3          scales_1.0.0          genefilter_1.66.0    
## [34] callr_3.3.1           stringr_1.4.0         digest_0.6.20        
## [37] pkgconfig_2.0.2       sessioninfo_1.1.1     limma_3.40.6         
## [40] highr_0.8             rstudioapi_0.10       RSQLite_2.1.2        
## [43] generics_0.0.2        BiocParallel_1.17.18  tokenizers_0.2.1     
## [46] RCurl_1.95-4.12       Matrix_1.2-17         Rcpp_1.0.2           
## [49] munsell_0.5.0         S4Vectors_0.22.0      fansi_0.4.0          
## [52] stringi_1.4.3         edgeR_3.26.6          pkgbuild_1.0.4       
## [55] plyr_1.8.4            grid_3.6.0            blob_1.2.0           
## [58] parallel_3.6.0        crayon_1.3.4          lattice_0.20-38      
## [61] splines_3.6.0         annotate_1.62.0       hms_0.5.0            
## [64] locfit_1.5-9.1        zeallot_0.1.0         ps_1.3.0             
## [67] pillar_1.4.2          reshape2_1.4.3        codetools_0.2-16     
## [70] stats4_3.6.0          pkgload_1.0.2         XML_3.98-1.20        
## [73] glue_1.3.1            evaluate_0.14         tidytext_0.2.2       
## [76] remotes_2.1.0         vctrs_0.2.0           testthat_2.2.1       
## [79] gtable_0.3.0          reshape_0.8.8         assertthat_0.2.1     
## [82] xfun_0.8              xtable_1.8-4          broom_0.5.2          
## [85] e1071_1.7-2           janeaustenr_0.1.5     class_7.3-15         
## [88] survival_2.44-1.1     iterators_1.0.12      IRanges_2.18.1       
## [91] AnnotationDbi_1.46.0  memoise_1.1.0         sva_3.32.1
</code></pre>

</body>

</html>
